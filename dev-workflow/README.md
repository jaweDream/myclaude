# /dev - 极简开发工作流

## 概述

全新设计的轻量级开发工作流，无历史包袱，专注快速交付高质量代码。

## 工作流程

```
/dev 触发
  ↓
AskUserQuestion（需求澄清）
  ↓
Codex 分析（提取要点和任务）
  ↓
develop-doc-generator（生成开发文档）
  ↓
Codex 并发开发（2-5个任务）
  ↓
Codex 测试验证（≥90%覆盖率）
  ↓
完成（生成总结）
```

## 6个步骤

### 1. 需求澄清
- 使用 **AskUserQuestion** 直接问用户
- 无评分系统，无复杂逻辑
- 2-3 轮问答直到需求明确

### 2. Codex 分析
- 调用 codex 分析需求
- 提取：核心功能、技术要点、任务列表（2-5个）
- 输出结构化分析结果

### 3. 生成开发文档
- 调用 **develop-doc-generator** agent
- 生成 `dev-plan.md`（单一开发文档）
- 包含：任务分解、文件范围、依赖关系、测试命令

### 4. 并发开发
- 基于 dev-plan.md 的任务列表
- 无依赖任务 → 并发执行
- 有冲突任务 → 串行执行

### 5. 测试验证
- 每个 codex 任务自己：
  - 实现功能
  - 编写测试
  - 运行覆盖率
  - 报告结果（≥90%）

### 6. 完成
- 汇总任务状态
- 记录覆盖率

## 使用方法

```bash
/dev "实现用户登录功能，支持邮箱和密码验证"
```

**无选项**，流程固定，开箱即用。

## 输出结构

```
.claude/specs/{feature_name}/
├── dev-plan.md      # 开发文档（agent生成）
```

仅 2 个文件，极简清晰。

## 核心组件

### 工具
- **AskUserQuestion**：交互式需求澄清
- **codex**：分析、开发、测试
- **develop-doc-generator**：生成开发文档（subagent，节省上下文）

## 核心特性

### ✅ 全新设计
- 无历史项目残留
- 无复杂评分逻辑
- 无多余抽象层

### ✅ 极简编排
- orchestrator 直接控制流程
- 只用 3 个工具/组件
- 步骤清晰易懂

### ✅ 并发能力
- 2-5 个任务并行
- 自动检测依赖和冲突
- codex 独立执行

### ✅ 质量保证
- 强制 90% 覆盖率
- codex 自己测试和验证
- 失败自动重试

## 示例

```bash
# 触发
/dev "添加用户登录功能"

# 步骤 1: 需求澄清
Q: 支持哪些登录方式？
A: 邮箱 + 密码
Q: 需要记住登录状态吗？
A: 是，使用 JWT token

# 步骤 2: Codex 分析
输出：
- 核心功能：邮箱密码登录 + JWT认证
- 任务 1：后端 API
- 任务 2：密码加密
- 任务 3：前端表单

# 步骤 3: 生成文档
dev-plan.md 已生成 ✓

# 步骤 4-5: 并发开发
[task-1] 后端API → 测试 → 92% ✓
[task-2] 密码加密 → 测试 → 95% ✓
[task-3] 前端表单 → 测试 → 91% ✓
```

## 目录结构

```
dev-workflow/
├── README.md                          # 本文档
├── commands/
│   └── dev.md                         # 工作流定义
└── agents/
    └── develop-doc-generator.md       # 文档生成器
```

极简结构，只有 3 个文件。

## 适用场景

✅ **适合**：
- 任何规模的功能开发
- 需要快速迭代
- 需要高测试覆盖率
- 希望并发提速

## 设计原则

1. **KISS**：保持简单愚蠢
2. **即用即抛**：无持久化配置
3. **质量优先**：强制 90% 覆盖率
4. **并发优先**：充分利用 codex 能力
5. **无历史包袱**：全新设计，不受其他项目影响

---

**哲学**：像 Linus 一样对复杂度零容忍，交付能立刻用的最小方案。
